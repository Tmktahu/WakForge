import{I as S,_ as ee,W as ae,i as z,r as q,c as G,x as B,D as V,X as ne,d as W,o as i,l as E,z as b,f as a,g as p,t as A,k as C,L as te,e as c,F as I,j,h as D,q as se,s as le,u as oe,y as P}from"./index-9f71af66.js";import{I as ce}from"./ItemStatList-bea69e30.js";const ue=()=>{const g=h=>{let y=O(h),f="https://www.wakfu.com/en/mmorpg/encyclopedia",u="";return h.type.validSlots.includes(S.FIRST_WEAPON.id)||h.type.validSlots.includes(S.SECOND_WEAPON.id)?u=`${f}/weapons/${y}`:h.type.validSlots.includes(S.PET.id)?u=`${f}/pets/${y}`:h.type.validSlots.includes(S.MOUNT.id)?u=`${f}/mounts/${y}`:h.type.validSlots.includes(S.ACCESSORY.id)?u=`${f}/accessories/${y}`:u=`${f}/armors/${y}`,u},O=h=>{let y=h.id,f=h.name.toLowerCase().replace(" ","-");return`${y}-${f}`};return{getItemEncyclopediaUrl:g}};const ie=g=>(se("data-v-2d73e57b"),g=g(),le(),g),re=ie(()=>a("div",{class:"drag-bar"},null,-1)),de={class:"edit-item-modal-content flex flex-column pb-2"},pe={class:"header-area flex px-3 pt-2 pb-1"},me={class:"flex flex-column ml-1"},ve={class:"item-name mr-2 truncate",style:{"max-width":"15ch"}},_e={class:"flex"},he={key:0},ye={key:1},fe=ie(()=>a("div",{class:"flex-grow-1"},null,-1)),ge={key:0,class:"random-mastery-section flex flex-column px-3"},ke={class:"text-center w-full text-lg mb-2 pt-2"},xe={class:"flex justify-content-center gap-2 px-3"},$e={key:0,class:"flex align-items-center"},Se={key:1},be={class:"flex align-items-center py-1 px-2"},we={class:"capitalize"},Ee={key:1,class:"random-resistance-section flex flex-column px-3"},Ae={class:"text-center w-full text-lg mb-2 pt-2"},Ce={class:"flex justify-content-center gap-2 px-3"},Ie={key:0,class:"flex align-items-center"},We={key:1},Oe={class:"flex align-items-center py-1 px-2"},qe={class:"capitalize"},Ne={class:"flex justify-content-center mt-2"},Re={__name:"EditEquipmentModal",setup(g,{expose:O}){let h=ae();const y=z("currentCharacter"),f=q(!1),u=q(null),o=q({}),k=[{value:"empty",label:"None",icon:"empty_coin"},{value:"water",label:"Water",icon:"water_coin"},{value:"earth",label:"Earth",icon:"earth_coin"},{value:"air",label:"Air",icon:"air_coin"},{value:"fire",label:"Fire",icon:"fire_coin"}],v=G(()=>{var t,e;return(e=(t=u.value)==null?void 0:t.equipEffects)==null?void 0:e.find(l=>l.id===1068)});B(v,()=>{V(()=>{N()})});const n=G(()=>{var t,e;return(e=(t=u.value)==null?void 0:t.equipEffects)==null?void 0:e.find(l=>l.id===1069)});B(n,()=>{V(()=>{R()})}),B(ne,()=>{N(),R()});const N=()=>{v.value!==void 0&&(o.value.masterySlot1=k.find(t=>{var e;return t.value===((e=v.value.masterySlot1)==null?void 0:e.type)}),o.value.masterySlot2=k.find(t=>{var e;return t.value===((e=v.value.masterySlot2)==null?void 0:e.type)}),o.value.masterySlot3=k.find(t=>{var e;return t.value===((e=v.value.masterySlot3)==null?void 0:e.type)}))},R=()=>{n.value!==void 0&&(o.value.resistanceSlot1=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot1)==null?void 0:l.type)}),o.value.resistanceSlot2=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot2)==null?void 0:l.type)}),o.value.resistanceSlot3=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot3)==null?void 0:l.type)}))},U=(t,e)=>{var _,s;let l=(s=(_=u.value)==null?void 0:_.equipEffects)==null?void 0:s.find(x=>x.id===1068);l[e]={type:o.value[e].value,value:v.value.values[0]},Object.keys(l).forEach(x=>{var m;x!==e&&((m=l[x])==null?void 0:m.type)===o.value[e].value&&(l[x]={type:k[0].value,value:[]},o.value[x]=k[0])})},T=()=>{Object.keys(o.value).forEach(t=>{var e,l;if(o.value[t]){let _=(l=(e=u.value)==null?void 0:e.equipEffects)==null?void 0:l.find(s=>s.id===1069);_[t]={type:o.value[t].value,value:n.value.values[0]}}})},M=()=>{Object.keys(y.value.equipment).forEach(t=>{y.value.equipment[t]!==null&&y.value.equipment[t].equipEffects.forEach(e=>{var l,_,s,x,m,r;e.id===1068&&v.value&&(e.values[2]>=1&&(e.masterySlot1={type:((l=o.value.masterySlot1)==null?void 0:l.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.masterySlot2={type:((_=o.value.masterySlot2)==null?void 0:_.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.masterySlot3={type:((s=o.value.masterySlot3)==null?void 0:s.value)||"empty",value:e.values[0]})),e.id===1069&&n.value&&(e.values[2]>=1&&(e.resistanceSlot1={type:((x=o.value.resistanceSlot1)==null?void 0:x.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.resistanceSlot2={type:((m=o.value.resistanceSlot2)==null?void 0:m.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.resistanceSlot3={type:((r=o.value.resistanceSlot3)==null?void 0:r.value)||"empty",value:e.values[0]}))})})},F=(t,e,l)=>{u.value=y.value.equipment[t],f.value=!0,V(()=>{let _=document.getElementById(h);_.style.position="fixed",_.style.left=`${e}px`,_.style.top=`${l}px`,N(),R()})},d=()=>{f.value=!1};return O({open:F}),(t,e)=>{const l=W("p-image"),_=W("p-button"),s=W("p-dropdown"),x=W("p-dialog");return i(),E(x,{id:C(h),visible:f.value,"onUpdate:visible":e[0]||(e[0]=m=>f.value=m)},{header:b(()=>[re]),default:b(()=>[a("div",de,[a("div",pe,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/items/${u.value.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",me,[a("div",ve,A(u.value.name),1),a("div",_e,[p(l,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${u.value.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),p(l,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${u.value.type.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),C(te).includes(u.value.type.id)?(i(),c("div",he,"Item Level: 50")):(i(),c("div",ye,"Level: "+A(u.value.level),1))])]),fe,p(_,{class:"close-button px-1 py-1",icon:"mdi mdi-close-thick",onClick:d})]),v.value?(i(),c("div",ge,[a("div",ke,"+"+A(v.value.values[0])+" Mastery Assignment",1),a("div",xe,[(i(!0),c(I,null,j(v.value.values[2],m=>(i(),E(s,{key:m,modelValue:o.value["masterySlot"+m],"onUpdate:modelValue":r=>o.value["masterySlot"+m]=r,class:"mastery-dropdown",options:k,onChange:r=>U(r,"masterySlot"+m)},{value:b(r=>[r.value?(i(),c("div",$e,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${r.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),c("span",Se,[p(l,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:b(r=>[a("div",be,[a("div",we,A(r.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))),128))])])):D("",!0),n.value?(i(),c("div",Ee,[a("div",Ae,"+"+A(n.value.values[0])+" Resistance Assignment",1),a("div",Ce,[(i(!0),c(I,null,j(n.value.values[2],m=>(i(),E(s,{key:m,modelValue:o.value["resistanceSlot"+m],"onUpdate:modelValue":r=>o.value["resistanceSlot"+m]=r,class:"mastery-dropdown",options:k,onChange:T},{value:b(r=>[r.value?(i(),c("div",Ie,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${r.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),c("span",We,[p(l,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:b(r=>[a("div",Oe,[a("div",qe,A(r.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])])):D("",!0),a("div",Ne,[p(_,{class:"py-2",label:"Apply to all Items",onClick:M})])])]),_:1},8,["id","visible"])}}},Te=ee(Re,[["__scopeId","data-v-2d73e57b"]]);const L=g=>(se("data-v-fdc5a1c2"),g=g(),le(),g),Me={class:"flex equipment-slots-wrapper"},je={key:0,class:"flex align-items-center justify-content-center"},De={key:1,class:"flex align-items-center justify-content-center"},Le={class:"flex align-items-center justify-content-center"},Be=L(()=>a("div",{class:"hover-icon search"},[a("i",{class:"pi pi-search"})],-1)),Ve={class:"flex align-items-center justify-content-center w-full",style:{position:"relative"}},Ue=["onClick"],Fe=L(()=>a("i",{class:"pi pi-pencil"},null,-1)),Pe=[Fe],ze=["onClick"],Ge=L(()=>a("i",{class:"pi pi-trash"},null,-1)),Xe=[Ge],Ye={key:0,class:"random-stat-icons-wrapper"},He={key:1,class:"random-stat-icons-wrapper"},Je={key:0,class:"item-card-tooltip"},Qe={class:"effect-header flex pt-2 px-1"},Ze={class:"flex flex-column"},Ke={class:"item-name mr-2"},et={class:"flex"},tt={key:0},st={key:1},lt=L(()=>a("div",{class:"flex-grow-1"},null,-1)),it={class:"flex"},at=L(()=>a("div",{class:"simple-tooltip"},"Open Encyclopedia Page",-1)),nt={__name:"EquipmentButtons",props:{character:{type:Object,default:()=>{}},readOnly:{type:Boolean,default:!1}},setup(g){let O=g;const h=oe(),{getItemEncyclopediaUrl:y}=ue(),f=z("itemFilters"),u=q(null),o=G(()=>{let d=v.value.equipment[S.FIRST_WEAPON.id];return d?!!d.type.disabledSlots.includes(S.SECOND_WEAPON.id):!1}),k=z("masterData"),v=q(O.character),n=q({});B(k,()=>{V(()=>{var d;v.value=O.character,n.value=(d=v.value)==null?void 0:d.equipment})},{immediate:!0});const N=d=>{f.itemTypeFilters.forEach(t=>{t.validSlots.includes(S[d])?t.checked=!0:t.checked=!1})},R=(d,t,e)=>{u.value[d].open(t,e.target.getBoundingClientRect().left-200,e.target.getBoundingClientRect().bottom+10)},U=(d,t)=>{h.require({group:"popup",target:t.currentTarget,message:"Are you sure?",accept:()=>{v.value.equipment[d]=null}})},T=d=>{var t;return((t=v.value.equipment[d])==null?void 0:t.equipEffects.find(e=>e.id===1068))||null},M=d=>{var t;return((t=v.value.equipment[d])==null?void 0:t.equipEffects.find(e=>e.id===1069))||null},F=d=>{let t=y(d);window.open(t,"_blank")};return(d,t)=>{const e=W("p-image"),l=W("p-button"),_=W("tippy");return i(),c("div",Me,[(i(!0),c(I,null,j(C(S),(s,x,m)=>{var r,X;return i(),c(I,{key:s.id},[g.readOnly?(i(),c("div",{key:0,class:P(["equipment-display",{"has-item":n.value[s.id]!==null}])},[(r=n.value[s.id])!=null&&r.imageId?(i(),c("div",je,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/items/${(X=n.value[s.id])==null?void 0:X.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])])):(i(),c("div",De,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${s.id}.png`,"image-style":"width: 60px"},null,8,["src"])]))],2)):(i(),c(I,{key:1},[n.value[s.id]===null?(i(),E(l,{key:0,class:P(["equipment-button",{"has-item":n.value[s.id]!==null,disabled:s.id===C(S).SECOND_WEAPON.id&&o.value}]),onClick:w=>N(s.id)},{default:b(()=>{var w;return[a("div",Le,[Be,s.id===C(S).SECOND_WEAPON.id&&o.value?(i(),E(e,{key:0,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[C(S).FIRST_WEAPON.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),E(e,{key:1,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${s.id}.png`,"image-style":"width: 60px"},null,8,["src"]))])]}),_:2},1032,["class","onClick"])):(i(),E(_,{key:1,placement:"bottom",interactive:""},{content:b(()=>{var w,$,Y,H,J,Q,Z,K;return[n.value[s.id]?(i(),c("div",Je,[a("div",Qe,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[s.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",Ze,[a("div",Ke,A(($=n.value[s.id])==null?void 0:$.name),1),a("div",et,[p(e,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${(Y=n.value[s.id])==null?void 0:Y.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),p(e,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${(J=(H=n.value[s.id])==null?void 0:H.type)==null?void 0:J.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),C(te).includes((Z=(Q=n.value[s.id])==null?void 0:Q.type)==null?void 0:Z.id)?(i(),c("div",tt,"Item Level: 50")):(i(),c("div",st,"Level: "+A((K=n.value[s.id])==null?void 0:K.level),1))])]),lt,a("div",it,[p(_,{placement:"left"},{content:b(()=>[at]),default:b(()=>[p(l,{icon:"pi pi-question-circle",class:"equip-button",onClick:ot=>F(n.value[s.id])},null,8,["onClick"])]),_:2},1024)])]),p(ce,{item:n.value[s.id]},null,8,["item"])])):D("",!0)]}),default:b(()=>{var w;return[a("div",{class:P(["equipment-button",{"has-item":n.value[s.id]!==null}])},[a("div",Ve,[a("div",{class:"hover-icon edit",onClick:$=>R(m,s.id,$)},Pe,8,Ue),a("div",{class:"hover-icon remove",onClick:$=>U(s.id,$)},Xe,8,ze),p(e,{class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[s.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),T(s.id)!==null?(i(),c("div",Ye,[(i(!0),c(I,null,j(T(s.id).values[2],$=>(i(),E(e,{key:$,src:`https://tmktahu.github.io/WakfuAssets/statistics/${T(s.id)[`masterySlot${$}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):D("",!0),M(s.id)!==null?(i(),c("div",He,[(i(!0),c(I,null,j(M(s.id).values[2],$=>(i(),E(e,{key:$,src:`https://tmktahu.github.io/WakfuAssets/statistics/${M(s.id)[`resistanceSlot${$}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):D("",!0)])],2)]}),_:2},1024)),p(Te,{ref_for:!0,ref_key:"editEquipmentModal",ref:u},null,512)],64))],64)}),128))])}}},rt=ee(nt,[["__scopeId","data-v-fdc5a1c2"]]);export{rt as E,ue as u};
