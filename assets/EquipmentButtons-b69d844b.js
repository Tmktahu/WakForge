import{J as S,_ as ee,Y as ae,i as z,r as O,e as Y,y as B,G as D,Z as ne,f as W,o as i,n as E,A as b,h as a,j as d,t as A,m as C,L as te,g as o,F as I,l as M,k as j,s as se,v as le,u as oe,a as ue,z as P}from"./index-4160b301.js";import{I as ce}from"./ItemStatList-41c3d15a.js";const re=()=>{const f=_=>{let h=q(_),y="https://www.wakfu.com/en/mmorpg/encyclopedia",c="";return _.type.validSlots.includes(S.FIRST_WEAPON.id)||_.type.validSlots.includes(S.SECOND_WEAPON.id)?c=`${y}/weapons/${h}`:_.type.validSlots.includes(S.PET.id)?c=`${y}/pets/${h}`:_.type.validSlots.includes(S.MOUNT.id)?c=`${y}/mounts/${h}`:_.type.validSlots.includes(S.ACCESSORY.id)?c=`${y}/accessories/${h}`:c=`${y}/armors/${h}`,c},q=_=>{let h=_.id,y=_.name.toLowerCase().replace(" ","-");return`${h}-${y}`};return{getItemEncyclopediaUrl:f}};const ie=f=>(se("data-v-a8f48e88"),f=f(),le(),f),de=ie(()=>a("div",{class:"drag-bar"},null,-1)),pe={class:"edit-item-modal-content flex flex-column pb-2"},me={class:"header-area flex px-3 pt-2 pb-1"},ve={class:"flex flex-column ml-1"},_e={class:"item-name mr-2 truncate",style:{"max-width":"15ch"}},he={class:"flex"},ye={key:0},fe={key:1},ge=ie(()=>a("div",{class:"flex-grow-1"},null,-1)),ke={key:0,class:"random-mastery-section flex flex-column px-3"},xe={class:"text-center w-full text-lg mb-2 pt-2"},$e={class:"flex justify-content-center gap-2 px-3"},Se={key:0,class:"flex align-items-center"},be={key:1},we={class:"flex align-items-center py-1 px-2"},Ee={class:"capitalize"},Ae={key:1,class:"random-resistance-section flex flex-column px-3"},Ce={class:"text-center w-full text-lg mb-2 pt-2"},Ie={class:"flex justify-content-center gap-2 px-3"},We={key:0,class:"flex align-items-center"},Oe={key:1},qe={class:"flex align-items-center py-1 px-2"},Ne={class:"capitalize"},Re={class:"flex justify-content-center mt-2"},Te={__name:"EditEquipmentModal",setup(f,{expose:q}){let _=ae();const h=z("currentCharacter"),y=O(!1),c=O(null),n=O({}),g=[{value:"empty",label:"None",icon:"empty_coin"},{value:"water",label:"Water",icon:"water_coin"},{value:"earth",label:"Earth",icon:"earth_coin"},{value:"air",label:"Air",icon:"air_coin"},{value:"fire",label:"Fire",icon:"fire_coin"}],x=Y(()=>{var s,e;return(e=(s=c.value)==null?void 0:s.equipEffects)==null?void 0:e.find(t=>t.id===1068)});B(x,()=>{D(()=>{u()})});const p=Y(()=>{var s,e;return(e=(s=c.value)==null?void 0:s.equipEffects)==null?void 0:e.find(t=>t.id===1069)});B(p,()=>{D(()=>{N()})}),B(ne,()=>{u(),N()});const u=()=>{x.value!==void 0&&(n.value.masterySlot1=g.find(s=>{var e;return s.value===((e=x.value.masterySlot1)==null?void 0:e.type)}),n.value.masterySlot2=g.find(s=>{var e;return s.value===((e=x.value.masterySlot2)==null?void 0:e.type)}),n.value.masterySlot3=g.find(s=>{var e;return s.value===((e=x.value.masterySlot3)==null?void 0:e.type)}))},N=()=>{p.value!==void 0&&(n.value.resistanceSlot1=g.find(s=>{var e,t;return s.value===((t=(e=p.value)==null?void 0:e.resistanceSlot1)==null?void 0:t.type)}),n.value.resistanceSlot2=g.find(s=>{var e,t;return s.value===((t=(e=p.value)==null?void 0:e.resistanceSlot2)==null?void 0:t.type)}),n.value.resistanceSlot3=g.find(s=>{var e,t;return s.value===((t=(e=p.value)==null?void 0:e.resistanceSlot3)==null?void 0:t.type)}))},V=(s,e)=>{var m,k;let t=(k=(m=c.value)==null?void 0:m.equipEffects)==null?void 0:k.find(l=>l.id===1068);t[e]={type:n.value[e].value,value:x.value.values[0]},Object.keys(t).forEach(l=>{var v;l!==e&&((v=t[l])==null?void 0:v.type)===n.value[e].value&&(t[l]={type:g[0].value,value:[]},n.value[l]=g[0])})},U=()=>{Object.keys(n.value).forEach(s=>{var e,t;if(n.value[s]){let m=(t=(e=c.value)==null?void 0:e.equipEffects)==null?void 0:t.find(k=>k.id===1069);m[s]={type:n.value[s].value,value:p.value.values[0]}}})},R=()=>{Object.keys(h.value.equipment).forEach(s=>{h.value.equipment[s]!==null&&h.value.equipment[s].equipEffects.forEach(e=>{var t,m,k,l,v,r;e.id===1068&&x.value&&(e.values[2]>=1&&(e.masterySlot1={type:((t=n.value.masterySlot1)==null?void 0:t.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.masterySlot2={type:((m=n.value.masterySlot2)==null?void 0:m.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.masterySlot3={type:((k=n.value.masterySlot3)==null?void 0:k.value)||"empty",value:e.values[0]})),e.id===1069&&p.value&&(e.values[2]>=1&&(e.resistanceSlot1={type:((l=n.value.resistanceSlot1)==null?void 0:l.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.resistanceSlot2={type:((v=n.value.resistanceSlot2)==null?void 0:v.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.resistanceSlot3={type:((r=n.value.resistanceSlot3)==null?void 0:r.value)||"empty",value:e.values[0]}))})})},T=(s,e,t)=>{c.value=h.value.equipment[s],y.value=!0,D(()=>{let m=document.getElementById(_);m.style.position="fixed",m.style.left=`${e}px`,m.style.top=`${t}px`,u(),N()})},F=()=>{y.value=!1};return q({open:T}),(s,e)=>{const t=W("p-image"),m=W("p-button"),k=W("p-dropdown"),l=W("p-dialog");return i(),E(l,{id:C(_),visible:y.value,"onUpdate:visible":e[0]||(e[0]=v=>y.value=v)},{header:b(()=>[de]),default:b(()=>[a("div",pe,[a("div",me,[d(t,{src:`https://tmktahu.github.io/WakfuAssets/items/${c.value.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",ve,[a("div",_e,A(c.value.name),1),a("div",he,[d(t,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${c.value.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),d(t,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${c.value.type.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),C(te).includes(c.value.type.id)?(i(),o("div",ye,"Item Level: 50")):(i(),o("div",fe,"Level: "+A(c.value.level),1))])]),ge,d(m,{class:"close-button px-1 py-1",icon:"mdi mdi-close-thick",onClick:F})]),x.value?(i(),o("div",ke,[a("div",xe,"+"+A(x.value.values[0])+" Mastery Assignment",1),a("div",$e,[(i(!0),o(I,null,M(x.value.values[2],v=>(i(),E(k,{key:v,modelValue:n.value["masterySlot"+v],"onUpdate:modelValue":r=>n.value["masterySlot"+v]=r,class:"mastery-dropdown",options:g,onChange:r=>V(r,"masterySlot"+v)},{value:b(r=>[r.value?(i(),o("div",Se,[d(t,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${r.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),o("span",be,[d(t,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:b(r=>[a("div",we,[a("div",Ee,A(r.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))),128))])])):j("",!0),p.value?(i(),o("div",Ae,[a("div",Ce,"+"+A(p.value.values[0])+" Resistance Assignment",1),a("div",Ie,[(i(!0),o(I,null,M(p.value.values[2],v=>(i(),E(k,{key:v,modelValue:n.value["resistanceSlot"+v],"onUpdate:modelValue":r=>n.value["resistanceSlot"+v]=r,class:"mastery-dropdown",options:g,onChange:U},{value:b(r=>[r.value?(i(),o("div",We,[d(t,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${r.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),o("span",Oe,[d(t,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:b(r=>[a("div",qe,[a("div",Ne,A(r.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])])):j("",!0),a("div",Re,[d(m,{class:"py-2",label:"Apply to all Items",onClick:R})])])]),_:1},8,["id","visible"])}}},Me=ee(Te,[["__scopeId","data-v-a8f48e88"]]);const L=f=>(se("data-v-4d8f2762"),f=f(),le(),f),je={class:"flex equipment-slots-wrapper"},Le={key:0,class:"flex align-items-center justify-content-center"},Be={key:1,class:"flex align-items-center justify-content-center"},De={class:"flex align-items-center justify-content-center"},Ve=L(()=>a("div",{class:"hover-icon search"},[a("i",{class:"pi pi-search"})],-1)),Ue={class:"flex align-items-center justify-content-center w-full",style:{position:"relative"}},Fe=["onClick"],Pe=L(()=>a("i",{class:"pi pi-pencil"},null,-1)),ze=[Pe],Ye=["onClick"],Ge=L(()=>a("i",{class:"pi pi-trash"},null,-1)),Je=[Ge],Ze={key:0,class:"random-stat-icons-wrapper"},He={key:1,class:"random-stat-icons-wrapper"},Qe={key:0,class:"item-card-tooltip"},Xe={class:"effect-header flex pt-2 px-1"},Ke={class:"flex flex-column"},et={class:"item-name mr-2"},tt={class:"flex"},st={key:0},lt={key:1},it=L(()=>a("div",{class:"flex-grow-1"},null,-1)),at={class:"flex"},nt=L(()=>a("div",{class:"simple-tooltip"},"Open Encyclopedia Page",-1)),ot={__name:"EquipmentButtons",props:{character:{type:Object,default:()=>{}},readOnly:{type:Boolean,default:!1}},setup(f){const{t:q}=oe();let _=f;const h=ue(),{getItemEncyclopediaUrl:y}=re(),c=z("itemFilters"),n=O(null),g=Y(()=>{let s=p.value.equipment[S.FIRST_WEAPON.id];return s?!!s.type.disabledSlots.includes(S.SECOND_WEAPON.id):!1}),x=z("masterData"),p=O(_.character),u=O({});B(x,()=>{D(()=>{var s;p.value=_.character,u.value=(s=p.value)==null?void 0:s.equipment})},{immediate:!0});const N=s=>{c.itemTypeFilters.forEach(e=>{e.validSlots.includes(S[s])?e.checked=!0:e.checked=!1})},V=(s,e,t)=>{n.value[s].open(e,t.target.getBoundingClientRect().left-200,t.target.getBoundingClientRect().bottom+10)},U=(s,e)=>{h.require({group:"popup",target:e.currentTarget,message:q("confirms.areYouSure"),accept:()=>{p.value.equipment[s]=null}})},R=s=>{var e;return((e=p.value.equipment[s])==null?void 0:e.equipEffects.find(t=>t.id===1068))||null},T=s=>{var e;return((e=p.value.equipment[s])==null?void 0:e.equipEffects.find(t=>t.id===1069))||null},F=s=>{let e=y(s);window.open(e,"_blank")};return(s,e)=>{const t=W("p-image"),m=W("p-button"),k=W("tippy");return i(),o("div",je,[(i(!0),o(I,null,M(C(S),(l,v,r)=>{var G,J;return i(),o(I,{key:l.id},[f.readOnly?(i(),o("div",{key:0,class:P(["equipment-display",{"has-item":u.value[l.id]!==null}])},[(G=u.value[l.id])!=null&&G.imageId?(i(),o("div",Le,[d(t,{src:`https://tmktahu.github.io/WakfuAssets/items/${(J=u.value[l.id])==null?void 0:J.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])])):(i(),o("div",Be,[d(t,{src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${l.id}.png`,"image-style":"width: 60px"},null,8,["src"])]))],2)):(i(),o(I,{key:1},[u.value[l.id]===null?(i(),E(m,{key:0,class:P(["equipment-button",{"has-item":u.value[l.id]!==null,disabled:l.id===C(S).SECOND_WEAPON.id&&g.value}]),onClick:w=>N(l.id)},{default:b(()=>{var w;return[a("div",De,[Ve,l.id===C(S).SECOND_WEAPON.id&&g.value?(i(),E(t,{key:0,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(w=u.value[C(S).FIRST_WEAPON.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),E(t,{key:1,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${l.id}.png`,"image-style":"width: 60px"},null,8,["src"]))])]}),_:2},1032,["class","onClick"])):(i(),E(k,{key:1,placement:"bottom",interactive:"",duration:"0"},{content:b(()=>{var w,$,Z,H,Q,X,K;return[u.value[l.id]?(i(),o("div",Qe,[a("div",Xe,[d(t,{src:`https://tmktahu.github.io/WakfuAssets/items/${(w=u.value[l.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",Ke,[a("div",et,A(s.$t(`items.${u.value[l.id].id}`)),1),a("div",tt,[d(t,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${($=u.value[l.id])==null?void 0:$.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),d(t,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${(H=(Z=u.value[l.id])==null?void 0:Z.type)==null?void 0:H.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),C(te).includes((X=(Q=u.value[l.id])==null?void 0:Q.type)==null?void 0:X.id)?(i(),o("div",st,"Item Level: 50")):(i(),o("div",lt,"Level: "+A((K=u.value[l.id])==null?void 0:K.level),1))])]),it,a("div",at,[d(k,{placement:"left"},{content:b(()=>[nt]),default:b(()=>[d(m,{icon:"pi pi-question-circle",class:"equip-button",onClick:ut=>F(u.value[l.id])},null,8,["onClick"])]),_:2},1024)])]),d(ce,{item:u.value[l.id]},null,8,["item"])])):j("",!0)]}),default:b(()=>{var w;return[a("div",{class:P(["equipment-button",{"has-item":u.value[l.id]!==null}])},[a("div",Ue,[a("div",{class:"hover-icon edit",onClick:$=>V(r,l.id,$)},ze,8,Fe),a("div",{class:"hover-icon remove",onClick:$=>U(l.id,$)},Je,8,Ye),d(t,{class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(w=u.value[l.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),R(l.id)!==null?(i(),o("div",Ze,[(i(!0),o(I,null,M(R(l.id).values[2],$=>(i(),E(t,{key:$,src:`https://tmktahu.github.io/WakfuAssets/statistics/${R(l.id)[`masterySlot${$}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):j("",!0),T(l.id)!==null?(i(),o("div",He,[(i(!0),o(I,null,M(T(l.id).values[2],$=>(i(),E(t,{key:$,src:`https://tmktahu.github.io/WakfuAssets/statistics/${T(l.id)[`resistanceSlot${$}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):j("",!0)])],2)]}),_:2},1024)),d(Me,{ref_for:!0,ref_key:"editEquipmentModal",ref:n},null,512)],64))],64)}),128))])}}},dt=ee(ot,[["__scopeId","data-v-4d8f2762"]]);export{dt as E,re as u};
