import{_ as te,u as se,a as ae,b as le,c as oe,i as re,r as S,d as ne,e as ce,f as j,g as h,o as i,h as v,j as s,t as p,k as o,l as ie,w as _,C as B,v as de,F as I,m as P,n as C,p as d,q as $,s as ue,x as pe}from"./index-5f11d770.js";import{a as F,E as G}from"./addCompanion-7eed7f17.js";const f=x=>(ue("data-v-78701a27"),x=x(),pe(),x),me={class:"flex flex-column flex-grow-1 ml-4 mr-3",style:{height:"100%",overflow:"hidden"}},he={class:"mt-3",style:{"font-size":"42px"}},ve={class:"mt-2"},_e={class:"flex align-items-center w-full"},fe={class:"text-xl mr-3"},ge={key:0,class:"mt-2",style:{color:"var(--error)"}},ye={class:"character-area"},Ce={class:"flex w-full"},xe={class:"text-xl"},ke=f(()=>s("div",{class:"flex-grow-1"},null,-1)),be={class:"character-enties-wrapper flex flex-column mt-2 pb-3"},we=["onDrop"],De=f(()=>s("i",{class:"mdi mdi-folder"},null,-1)),Be={class:"flex"},Ie={class:"mx-2"},Pe=f(()=>s("i",{class:"mdi mdi-pencil"},null,-1)),$e={class:"px-3"},Te=f(()=>s("div",{class:"flex-grow-1"},null,-1)),Ve=["onDrop"],Ee=["onClick","onDragstart"],Ne={class:"character-info flex align-items-center justify-content-left flex-grow-1"},Le={class:"ml-3"},Ue={class:"class-name flex-grow-1 truncate"},Re={class:"class-level"},Ae={class:"character-items flex-grow-1"},Se=f(()=>s("i",{class:"mdi mdi-folder"},null,-1)),je=f(()=>s("div",{class:"mx-2"},"Ungrouped",-1)),Fe=f(()=>s("div",{class:"flex-grow-1"},null,-1)),Ge=["onClick","onDragstart"],Oe={class:"character-info flex align-items-center justify-content-left flex-grow-1"},qe={class:"ml-3"},We={class:"class-name flex-grow-1 truncate"},ze={class:"class-level"},He={class:"character-items flex-grow-1"},Me={__name:"CharactersPage",setup(x){var U,R;const O=se(),q=ae(),{t:T}=le(),D=oe(),n=re("masterData"),g=S(""),{decodeBuildCode:W}=ne(),{createNewCharacter:z,createNewCharacterFromCode:H,deleteCharacter:M}=ce(n),Y=S([...((U=n.groups)==null?void 0:U.keys())||[0],(R=n.groups)==null?void 0:R.length]),V=j(()=>W(g.value)!==null),J=j(()=>{var r;let t=[];return(r=n.groups)==null||r.forEach(c=>{t.push(...c.buildIds)}),n.characters.filter(c=>!t.includes(c.id))}),E=t=>{let e=z();t!=="none"&&t.buildIds.push(e.id),D.push({name:B,params:{characterId:e.id}})},K=()=>{let t=H(g.value);D.push({name:B,params:{characterId:t.id}})},Q=()=>{n.groups.push({id:de(),name:T("charactersPage.newGroup"),buildIds:[]})},X=t=>{if(t.buildIds.length===0){let e=n.groups.indexOf(t);n.groups.splice(e,1)}else O.add({severity:"error",summary:"You cannot delete a group that has characters in it.",life:3e3})},k=(t,e)=>{q.require({group:"popup",target:t.currentTarget,message:T("confirms.irreversable"),accept:()=>{n.groups.forEach(r=>{if(r.buildIds.includes(e)){let c=r.buildIds.indexOf(e);r.buildIds.splice(c,1)}}),M(e)}})},N=(t,e)=>{t.target.classList.contains("delete-button")||D.push({name:B,params:{characterId:e}})},y=t=>n.characters.find(e=>e.id===t),L=(t,e)=>{t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("buildId",e)},b=(t,e)=>{try{let r=t.dataTransfer.getData("buildId");r&&r!==""&&(n.groups.forEach(c=>{if(c.buildIds.includes(r)){let u=c.buildIds.indexOf(r);c.buildIds.splice(u,1)}}),e!=="none"&&e.buildIds.push(r))}catch{}};return(t,e)=>{const r=h("p-divider"),c=h("p-inputText"),u=h("p-button"),Z=h("p-inplace"),w=h("p-image"),A=h("p-accordionTab"),ee=h("p-accordion");return i(),v("div",me,[s("div",he,p(t.$t("charactersPage.title")),1),s("div",ve,p(t.$t("charactersPage.description")),1),o(r),s("div",null,[s("div",_e,[s("div",fe,p(t.$t("charactersPage.codeInputLabel"))+":",1),o(c,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),placeholder:t.$t("charactersPage.codeInputPlaceholder"),class:"flex-grow-1 py-2"},null,8,["modelValue","placeholder"]),o(u,{icon:"mdi mdi-plus-thick",disabled:!V.value,label:t.$t("charactersPage.codeInputButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:K},null,8,["disabled","label"])]),!V.value&&g.value!==""?(i(),v("div",ge,p(t.$t("charactersPage.invalidBuildCode")),1)):ie("",!0)]),o(r),s("div",ye,[s("div",Ce,[s("div",xe,p(t.$t("charactersPage.savedCharactersTitle")),1),ke,o(u,{icon:"mdi mdi-folder",label:t.$t("charactersPage.createNewGroupButton"),class:"create-character-button py-1 pr-3 pl-2",onClick:Q},null,8,["label"])]),s("div",be,[o(ee,{multiple:"","active-index":Y.value},{default:_(()=>[(i(!0),v(I,null,P($(n).groups,a=>(i(),C(A,{key:a.id},{header:_(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",onDrop:l=>b(l,a),onDragover:e[2]||(e[2]=d(()=>{},["prevent"])),onDragenter:e[3]||(e[3]=d(()=>{},["prevent"]))},[De,o(Z,{closable:!0,pt:{content:{class:"flex align-items-center"},button:{class:"py-1"}},onClick:e[1]||(e[1]=d(()=>{},["stop"]))},{display:_(()=>[s("div",Be,[s("div",Ie,p(a.name),1),Pe])]),content:_(()=>[s("div",$e,[o(c,{modelValue:a.name,"onUpdate:modelValue":l=>a.name=l,class:"py-1",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),Te,o(u,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:d(l=>E(a),["stop"])},null,8,["label","onClick"]),o(u,{icon:"pi pi-trash",class:"ml-3 py-1",onClick:d(l=>X(a),["stop"])},null,8,["onClick"])],40,we)]),default:_(()=>[s("div",{onDrop:l=>b(l,a),onDragover:e[4]||(e[4]=d(()=>{},["prevent"])),onDragenter:e[5]||(e[5]=d(()=>{},["prevent"]))},[(i(!0),v(I,null,P(a.buildIds,l=>(i(),v("div",{key:l,class:"character-entry py-2 mt-2",draggable:"true",onClick:m=>N(m,l),onDragstart:m=>L(m,l)},[s("div",Ne,[s("div",Le,[y(l).class?(i(),C(w,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${y(l).class}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),C(w,{key:1,class:"class-image",src:$(F),"image-style":"width: 40px"},null,8,["src"]))]),o(r,{class:"mx-2",layout:"vertical"}),s("div",Ue,p(y(l).name),1),o(r,{class:"mx-2",layout:"vertical"}),s("div",Re,"Lvl "+p(y(l).level),1),o(r,{class:"mx-2",layout:"vertical"}),o(u,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>k(m,l)},null,8,["onClick"])]),s("div",Ae,[o(G,{character:y(l),"read-only":""},null,8,["character"])]),o(u,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>k(m,l)},null,8,["onClick"])],40,Ee))),128))],40,Ve)]),_:2},1024))),128)),o(A,null,{header:_(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",draggable:"true",onDrop:e[7]||(e[7]=a=>b(a,"none")),onDragover:e[8]||(e[8]=d(()=>{},["prevent"])),onDragenter:e[9]||(e[9]=d(()=>{},["prevent"]))},[Se,je,Fe,o(u,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:e[6]||(e[6]=d(a=>E("none"),["stop"]))},null,8,["label"])],32)]),default:_(()=>[s("div",{onDrop:e[10]||(e[10]=a=>b(a,t.group)),onDragover:e[11]||(e[11]=d(()=>{},["prevent"])),onDragenter:e[12]||(e[12]=d(()=>{},["prevent"]))},[(i(!0),v(I,null,P(J.value,a=>(i(),v("div",{key:a.id,class:"character-entry py-2 mt-2",draggable:"true",onClick:l=>N(l,a.id),onDragstart:l=>L(l,a.id)},[s("div",Oe,[s("div",qe,[a.class?(i(),C(w,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${a.class}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),C(w,{key:1,class:"class-image",src:$(F),"image-style":"width: 40px"},null,8,["src"]))]),o(r,{class:"mx-2",layout:"vertical"}),s("div",We,p(a.name),1),o(r,{class:"mx-2",layout:"vertical"}),s("div",ze,"Lvl "+p(a.level),1),o(r,{class:"mx-2",layout:"vertical"}),o(u,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:l=>k(l,a.id)},null,8,["onClick"])]),s("div",He,[o(G,{character:a,"read-only":""},null,8,["character"])]),o(u,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:l=>k(l,a.id)},null,8,["onClick"])],40,Ge))),128))],32)]),_:1})]),_:1},8,["active-index"])])])])}}},Ke=te(Me,[["__scopeId","data-v-78701a27"]]);export{Ke as default};
