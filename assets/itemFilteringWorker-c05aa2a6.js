(function(){"use strict";let f=null;const d=(r,t)=>{let n=c(r,t).filter(e=>h(e,t)&&T(e,t)&&m(e,t)&&E(e,t));p(n)},c=(r,t)=>{let l=structuredClone(r);for(let n in t.sortingParams){let e=t.sortingParams[n].sortBy,a=t.sortingParams[n].sortOrder;e.id!=="none"&&(l=l.sort((u,s)=>v(u,s,e,a)))}return l},v=(r,t,l,n)=>{if(l.id==="level")return n.id==="ascending"?r.level-t.level:t.level-r.level;if(l.id==="name"){let e=r.name.toLowerCase(),a=t.name.toLowerCase();return n.id==="ascending"?e<a?-1:e>a?1:0:e>a?-1:e<a?1:0}else return g(r,t,l,n)},g=(r,t,l,n)=>{var u,s;let e=-1e4,a=-1e4;if((u=r.equipEffects)!=null&&u.length){let i=r.equipEffects.find(o=>o.id===l.id);i!==void 0&&(e=i.values[0])}if((s=t.equipEffects)!=null&&s.length){let i=t.equipEffects.find(o=>o.id===l.id);i!==void 0&&(a=i.values[0])}return n.id==="ascending"?e-a:a-e},h=(r,t)=>t.startLevel<=r.level&&r.level<=t.endLevel,T=(r,t)=>{var n;if(t.effectFilters.length===0)return!0;if(((n=r.equipEffects)==null?void 0:n.length)===void 0||r.equipEffects.length===0)return!1;let l=!0;return t.effectFilters.some(e=>{let a=f[e.type.value],u=!1;return r.equipEffects.some(s=>a.rawIds.includes(s.id)?(u=!0,e.comparator.id==="equalTo"?l=s.values[0]===e.value:e.comparator.id==="greaterThanOrEqualTo"?l=s.values[0]>=e.value:e.comparator.id==="lessThanOrEqualTo"?l=s.values[0]<=e.value:console.error("Unknown comparator when trying to evaluate effect filters."),!0):!1),u===!1&&(e.comparator.id==="equalTo"?l=e.value===0:e.comparator.id==="greaterThanOrEqualTo"?l=e.value<=0:e.comparator.id==="lessThanOrEqualTo"&&(l=e.value>=0)),l===!1}),l},m=(r,t)=>{let l=r.rarity,n=!1;return t.rarityFilters.some(e=>e.checked&&e.id===l?(n=!0,!0):!1),n},E=(r,t)=>{if(t.itemTypeFilters.length===0)return!0;let l=r.type.id,n=!1;return t.itemTypeFilters.some(e=>e.checked&&e.rawId===l?(n=!0,!0):!1),n},p=r=>{postMessage({items:r,error:null})};onmessage=async r=>{let t=r.data.params,l=r.data.itemData;f=r.data.EFFECT_TYPE_DATA,d(l,t)}})();
