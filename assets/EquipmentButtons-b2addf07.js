import{J as S,_ as K,X as ie,i as z,r as q,c as G,x as D,G as V,Y as ae,d as W,o as i,l as E,z as b,f as a,g as p,t as A,k as C,L as ee,e as u,F as I,j,h as L,q as te,s as se,u as ne,y as P}from"./index-251c76de.js";import{I as oe}from"./ItemStatList-62f2b3ab.js";const ue=()=>{const g=h=>{let y=O(h),f="https://www.wakfu.com/en/mmorpg/encyclopedia",c="";return h.type.validSlots.includes(S.FIRST_WEAPON.id)||h.type.validSlots.includes(S.SECOND_WEAPON.id)?c=`${f}/weapons/${y}`:h.type.validSlots.includes(S.PET.id)?c=`${f}/pets/${y}`:h.type.validSlots.includes(S.MOUNT.id)?c=`${f}/mounts/${y}`:h.type.validSlots.includes(S.ACCESSORY.id)?c=`${f}/accessories/${y}`:c=`${f}/armors/${y}`,c},O=h=>{let y=h.id,f=h.name.toLowerCase().replace(" ","-");return`${y}-${f}`};return{getItemEncyclopediaUrl:g}};const le=g=>(te("data-v-2d73e57b"),g=g(),se(),g),ce=le(()=>a("div",{class:"drag-bar"},null,-1)),re={class:"edit-item-modal-content flex flex-column pb-2"},de={class:"header-area flex px-3 pt-2 pb-1"},pe={class:"flex flex-column ml-1"},me={class:"item-name mr-2 truncate",style:{"max-width":"15ch"}},ve={class:"flex"},_e={key:0},he={key:1},ye=le(()=>a("div",{class:"flex-grow-1"},null,-1)),fe={key:0,class:"random-mastery-section flex flex-column px-3"},ge={class:"text-center w-full text-lg mb-2 pt-2"},ke={class:"flex justify-content-center gap-2 px-3"},xe={key:0,class:"flex align-items-center"},$e={key:1},Se={class:"flex align-items-center py-1 px-2"},be={class:"capitalize"},we={key:1,class:"random-resistance-section flex flex-column px-3"},Ee={class:"text-center w-full text-lg mb-2 pt-2"},Ae={class:"flex justify-content-center gap-2 px-3"},Ce={key:0,class:"flex align-items-center"},Ie={key:1},We={class:"flex align-items-center py-1 px-2"},Oe={class:"capitalize"},qe={class:"flex justify-content-center mt-2"},Ne={__name:"EditEquipmentModal",setup(g,{expose:O}){let h=ie();const y=z("currentCharacter"),f=q(!1),c=q(null),o=q({}),k=[{value:"empty",label:"None",icon:"empty_coin"},{value:"water",label:"Water",icon:"water_coin"},{value:"earth",label:"Earth",icon:"earth_coin"},{value:"air",label:"Air",icon:"air_coin"},{value:"fire",label:"Fire",icon:"fire_coin"}],v=G(()=>{var t,e;return(e=(t=c.value)==null?void 0:t.equipEffects)==null?void 0:e.find(l=>l.id===1068)});D(v,()=>{V(()=>{N()})});const n=G(()=>{var t,e;return(e=(t=c.value)==null?void 0:t.equipEffects)==null?void 0:e.find(l=>l.id===1069)});D(n,()=>{V(()=>{R()})}),D(ae,()=>{N(),R()});const N=()=>{v.value!==void 0&&(o.value.masterySlot1=k.find(t=>{var e;return t.value===((e=v.value.masterySlot1)==null?void 0:e.type)}),o.value.masterySlot2=k.find(t=>{var e;return t.value===((e=v.value.masterySlot2)==null?void 0:e.type)}),o.value.masterySlot3=k.find(t=>{var e;return t.value===((e=v.value.masterySlot3)==null?void 0:e.type)}))},R=()=>{n.value!==void 0&&(o.value.resistanceSlot1=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot1)==null?void 0:l.type)}),o.value.resistanceSlot2=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot2)==null?void 0:l.type)}),o.value.resistanceSlot3=k.find(t=>{var e,l;return t.value===((l=(e=n.value)==null?void 0:e.resistanceSlot3)==null?void 0:l.type)}))},U=(t,e)=>{var _,s;let l=(s=(_=c.value)==null?void 0:_.equipEffects)==null?void 0:s.find(x=>x.id===1068);l[e]={type:o.value[e].value,value:v.value.values[0]},Object.keys(l).forEach(x=>{var m;x!==e&&((m=l[x])==null?void 0:m.type)===o.value[e].value&&(l[x]={type:k[0].value,value:[]},o.value[x]=k[0])})},T=()=>{Object.keys(o.value).forEach(t=>{var e,l;if(o.value[t]){let _=(l=(e=c.value)==null?void 0:e.equipEffects)==null?void 0:l.find(s=>s.id===1069);_[t]={type:o.value[t].value,value:n.value.values[0]}}})},M=()=>{Object.keys(y.value.equipment).forEach(t=>{y.value.equipment[t]!==null&&y.value.equipment[t].equipEffects.forEach(e=>{var l,_,s,x,m,d;e.id===1068&&v.value&&(e.values[2]>=1&&(e.masterySlot1={type:((l=o.value.masterySlot1)==null?void 0:l.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.masterySlot2={type:((_=o.value.masterySlot2)==null?void 0:_.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.masterySlot3={type:((s=o.value.masterySlot3)==null?void 0:s.value)||"empty",value:e.values[0]})),e.id===1069&&n.value&&(e.values[2]>=1&&(e.resistanceSlot1={type:((x=o.value.resistanceSlot1)==null?void 0:x.value)||"empty",value:e.values[0]}),e.values[2]>=2&&(e.resistanceSlot2={type:((m=o.value.resistanceSlot2)==null?void 0:m.value)||"empty",value:e.values[0]}),e.values[2]>=3&&(e.resistanceSlot3={type:((d=o.value.resistanceSlot3)==null?void 0:d.value)||"empty",value:e.values[0]}))})})},F=(t,e,l)=>{c.value=y.value.equipment[t],f.value=!0,V(()=>{let _=document.getElementById(h);_.style.position="fixed",_.style.left=`${e}px`,_.style.top=`${l}px`,N(),R()})},r=()=>{f.value=!1};return O({open:F}),(t,e)=>{const l=W("p-image"),_=W("p-button"),s=W("p-dropdown"),x=W("p-dialog");return i(),E(x,{id:C(h),visible:f.value,"onUpdate:visible":e[0]||(e[0]=m=>f.value=m)},{header:b(()=>[ce]),default:b(()=>[a("div",re,[a("div",de,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/items/${c.value.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",pe,[a("div",me,A(c.value.name),1),a("div",ve,[p(l,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${c.value.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),p(l,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${c.value.type.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),C(ee).includes(c.value.type.id)?(i(),u("div",_e,"Item Level: 50")):(i(),u("div",he,"Level: "+A(c.value.level),1))])]),ye,p(_,{class:"close-button px-1 py-1",icon:"mdi mdi-close-thick",onClick:r})]),v.value?(i(),u("div",fe,[a("div",ge,"+"+A(v.value.values[0])+" Mastery Assignment",1),a("div",ke,[(i(!0),u(I,null,j(v.value.values[2],m=>(i(),E(s,{key:m,modelValue:o.value["masterySlot"+m],"onUpdate:modelValue":d=>o.value["masterySlot"+m]=d,class:"mastery-dropdown",options:k,onChange:d=>U(d,"masterySlot"+m)},{value:b(d=>[d.value?(i(),u("div",xe,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${d.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),u("span",$e,[p(l,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:b(d=>[a("div",Se,[a("div",be,A(d.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))),128))])])):L("",!0),n.value?(i(),u("div",we,[a("div",Ee,"+"+A(n.value.values[0])+" Resistance Assignment",1),a("div",Ae,[(i(!0),u(I,null,j(n.value.values[2],m=>(i(),E(s,{key:m,modelValue:o.value["resistanceSlot"+m],"onUpdate:modelValue":d=>o.value["resistanceSlot"+m]=d,class:"mastery-dropdown",options:k,onChange:T},{value:b(d=>[d.value?(i(),u("div",Ce,[p(l,{src:`https://tmktahu.github.io/WakfuAssets/statistics/${d.value.icon}.png`,style:{height:"40px"},"image-style":"height: 40px; margin-top: -1px"},null,8,["src"])])):(i(),u("span",Ie,[p(l,{src:"https://tmktahu.github.io/WakfuAssets/statistics/empty_coin.png",style:{height:"36px"},"image-style":"height: 36px; margin-top: 1px; margin-left: 2px"},null,8,["src"])]))]),option:b(d=>[a("div",We,[a("div",Oe,A(d.option.label),1)])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))])])):L("",!0),a("div",qe,[p(_,{class:"py-2",label:"Apply to all Items",onClick:M})])])]),_:1},8,["id","visible"])}}},Re=K(Ne,[["__scopeId","data-v-2d73e57b"]]);const B=g=>(te("data-v-ff824eee"),g=g(),se(),g),Te={class:"flex equipment-slots-wrapper"},Me={key:0,class:"flex align-items-center justify-content-center"},je={key:1,class:"flex align-items-center justify-content-center"},Le={class:"flex align-items-center justify-content-center"},Be=B(()=>a("div",{class:"hover-icon search"},[a("i",{class:"pi pi-search"})],-1)),De={class:"flex align-items-center justify-content-center w-full",style:{position:"relative"}},Ve=["onClick"],Ue=B(()=>a("i",{class:"pi pi-pencil"},null,-1)),Fe=[Ue],Pe=["onClick"],ze=B(()=>a("i",{class:"pi pi-trash"},null,-1)),Ge=[ze],Ye={key:0,class:"random-stat-icons-wrapper"},Je={key:1,class:"random-stat-icons-wrapper"},Xe={key:0,class:"item-card-tooltip"},He={class:"effect-header flex pt-2 px-1"},Qe={class:"flex flex-column"},Ze={class:"item-name mr-2"},Ke={class:"flex"},et={key:0},tt={key:1},st=B(()=>a("div",{class:"flex-grow-1"},null,-1)),lt={class:"flex"},it=B(()=>a("div",{class:"simple-tooltip"},"Open Encyclopedia Page",-1)),at={__name:"EquipmentButtons",props:{character:{type:Object,default:()=>{}},readOnly:{type:Boolean,default:!1}},setup(g){let O=g;const h=ne(),{getItemEncyclopediaUrl:y}=ue(),f=z("itemFilters"),c=q(null),o=G(()=>{let r=v.value.equipment[S.FIRST_WEAPON.id];return r?!!r.type.disabledSlots.includes(S.SECOND_WEAPON.id):!1}),k=z("masterData"),v=q(O.character),n=q({});D(k,()=>{V(()=>{var r;v.value=O.character,n.value=(r=v.value)==null?void 0:r.equipment})},{immediate:!0});const N=r=>{f.itemTypeFilters.forEach(t=>{t.validSlots.includes(S[r])?t.checked=!0:t.checked=!1})},R=(r,t,e)=>{c.value[r].open(t,e.target.getBoundingClientRect().left-200,e.target.getBoundingClientRect().bottom+10)},U=(r,t)=>{h.require({group:"popup",target:t.currentTarget,message:"Are you sure?",accept:()=>{v.value.equipment[r]=null}})},T=r=>{var t;return((t=v.value.equipment[r])==null?void 0:t.equipEffects.find(e=>e.id===1068))||null},M=r=>{var t;return((t=v.value.equipment[r])==null?void 0:t.equipEffects.find(e=>e.id===1069))||null},F=r=>{let t=y(r);window.open(t,"_blank")};return(r,t)=>{const e=W("p-image"),l=W("p-button"),_=W("tippy");return i(),u("div",Te,[(i(!0),u(I,null,j(C(S),(s,x,m)=>{var d,Y;return i(),u(I,{key:s.id},[g.readOnly?(i(),u("div",{key:0,class:P(["equipment-display",{"has-item":n.value[s.id]!==null}])},[(d=n.value[s.id])!=null&&d.imageId?(i(),u("div",Me,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/items/${(Y=n.value[s.id])==null?void 0:Y.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])])):(i(),u("div",je,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${s.id}.png`,"image-style":"width: 60px"},null,8,["src"])]))],2)):(i(),u(I,{key:1},[n.value[s.id]===null?(i(),E(l,{key:0,class:P(["equipment-button",{"has-item":n.value[s.id]!==null,disabled:s.id===C(S).SECOND_WEAPON.id&&o.value}]),onClick:w=>N(s.id)},{default:b(()=>{var w;return[a("div",Le,[Be,s.id===C(S).SECOND_WEAPON.id&&o.value?(i(),E(e,{key:0,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[C(S).FIRST_WEAPON.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),E(e,{key:1,class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/equipmentDefaults/${s.id}.png`,"image-style":"width: 60px"},null,8,["src"]))])]}),_:2},1032,["class","onClick"])):(i(),E(_,{key:1,placement:"bottom",interactive:"",duration:"0"},{content:b(()=>{var w,$,J,X,H,Q,Z;return[n.value[s.id]?(i(),u("div",Xe,[a("div",He,[p(e,{src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[s.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),a("div",Qe,[a("div",Ze,A(r.$t(`items.${n.value[s.id].id}`)),1),a("div",Ke,[p(e,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/rarities/${($=n.value[s.id])==null?void 0:$.rarity}.png`,"image-style":"width: 12px;"},null,8,["src"]),p(e,{class:"mr-1",src:`https://tmktahu.github.io/WakfuAssets/itemTypes/${(X=(J=n.value[s.id])==null?void 0:J.type)==null?void 0:X.id}.png`,"image-style":"width: 18px;"},null,8,["src"]),C(ee).includes((Q=(H=n.value[s.id])==null?void 0:H.type)==null?void 0:Q.id)?(i(),u("div",et,"Item Level: 50")):(i(),u("div",tt,"Level: "+A((Z=n.value[s.id])==null?void 0:Z.level),1))])]),st,a("div",lt,[p(_,{placement:"left"},{content:b(()=>[it]),default:b(()=>[p(l,{icon:"pi pi-question-circle",class:"equip-button",onClick:nt=>F(n.value[s.id])},null,8,["onClick"])]),_:2},1024)])]),p(oe,{item:n.value[s.id]},null,8,["item"])])):L("",!0)]}),default:b(()=>{var w;return[a("div",{class:P(["equipment-button",{"has-item":n.value[s.id]!==null}])},[a("div",De,[a("div",{class:"hover-icon edit",onClick:$=>R(m,s.id,$)},Fe,8,Ve),a("div",{class:"hover-icon remove",onClick:$=>U(s.id,$)},Ge,8,Pe),p(e,{class:"equipment-image",src:`https://tmktahu.github.io/WakfuAssets/items/${(w=n.value[s.id])==null?void 0:w.imageId}.png`,"image-style":"width: 40px"},null,8,["src"]),T(s.id)!==null?(i(),u("div",Ye,[(i(!0),u(I,null,j(T(s.id).values[2],$=>(i(),E(e,{key:$,src:`https://tmktahu.github.io/WakfuAssets/statistics/${T(s.id)[`masterySlot${$}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):L("",!0),M(s.id)!==null?(i(),u("div",Je,[(i(!0),u(I,null,j(M(s.id).values[2],$=>(i(),E(e,{key:$,src:`https://tmktahu.github.io/WakfuAssets/statistics/${M(s.id)[`resistanceSlot${$}`].type}_coin.png`,"image-style":"width: 16px"},null,8,["src"]))),128))])):L("",!0)])],2)]}),_:2},1024)),p(Re,{ref_for:!0,ref_key:"editEquipmentModal",ref:c},null,512)],64))],64)}),128))])}}},ct=K(at,[["__scopeId","data-v-ff824eee"]]);export{ct as E,ue as u};
