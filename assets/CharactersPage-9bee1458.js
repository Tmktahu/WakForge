import{_ as te,u as se,a as ae,b as le,c as oe,i as re,r as S,d as ne,e as ce,f as j,g as h,o as i,h as f,j as s,t as p,k as r,l as ie,w as v,C as B,v as de,F as I,m as P,n as C,p as d,q as $,s as ue,x as pe}from"./index-7d05648d.js";import{a as F,E as G}from"./addCompanion-6ed12064.js";const _=x=>(ue("data-v-ff92eafd"),x=x(),pe(),x),me={class:"flex flex-column flex-grow-1 ml-4 mr-3",style:{height:"100%",overflow:"hidden"}},he={class:"mt-3",style:{"font-size":"42px"}},fe={class:"mt-2"},ve={class:"flex align-items-center w-full"},_e={class:"text-xl mr-3"},ge={key:0,class:"mt-2",style:{color:"var(--error)"}},ye={class:"character-area"},Ce={class:"flex w-full"},xe={class:"text-xl"},ke=_(()=>s("div",{class:"flex-grow-1"},null,-1)),be={class:"character-enties-wrapper flex flex-column mt-2 pb-3"},we=["onDrop"],De=_(()=>s("i",{class:"mdi mdi-folder"},null,-1)),Be={class:"flex"},Ie={class:"mx-2"},Pe=_(()=>s("i",{class:"mdi mdi-pencil"},null,-1)),$e={class:"px-3"},Te=_(()=>s("div",{class:"flex-grow-1"},null,-1)),Ve=["onDrop"],Ee=["onClick","onDragstart"],Ne={class:"character-info flex align-items-center justify-content-left flex-grow-1"},Le={class:"ml-3"},Ue={class:"class-name flex-grow-1 truncate"},Re={class:"class-level"},Ae={class:"character-items flex-grow-1"},Se=_(()=>s("i",{class:"mdi mdi-folder"},null,-1)),je=_(()=>s("div",{class:"mx-2"},"Ungrouped",-1)),Fe=_(()=>s("div",{class:"flex-grow-1"},null,-1)),Ge=["onClick","onDragstart"],Oe={class:"character-info flex align-items-center justify-content-left flex-grow-1"},qe={class:"ml-3"},We={class:"class-name flex-grow-1 truncate"},ze={class:"class-level"},He={class:"character-items flex-grow-1"},Ke={__name:"CharactersPage",setup(x){var U,R;const O=se(),q=ae(),{t:T}=le(),k=oe(),n=re("masterData"),g=S(""),{decodeBuildCode:W}=ne(),{createNewCharacter:z,createNewCharacterFromCode:H,deleteCharacter:K}=ce(n),M=S([...((U=n.groups)==null?void 0:U.keys())||[0],(R=n.groups)==null?void 0:R.length]),V=j(()=>W(g.value)!==null),Y=j(()=>{var l;let t=[];return(l=n.groups)==null||l.forEach(c=>{t.push(...c.buildIds)}),n.characters.filter(c=>!t.includes(c.id))}),E=t=>{let e=z();t!=="none"&&t.buildIds.push(e.id),k.push({name:B,params:{characterId:e.id}})},J=()=>{let t=H(g.value);k.push({name:B,params:{characterId:t.id}})},Q=()=>{n.groups.push({id:de(),name:T("charactersPage.newGroup"),buildIds:[]})},X=t=>{if(t.buildIds.length===0){let e=n.groups.indexOf(t);n.groups.splice(e,1)}else O.add({severity:"error",summary:"You cannot delete a group that has characters in it.",life:3e3})},b=(t,e)=>{q.require({group:"popup",target:t.currentTarget,message:T("confirms.irreversable"),accept:()=>{n.groups.forEach(l=>{if(l.buildIds.includes(e)){let c=l.buildIds.indexOf(e);l.buildIds.splice(c,1)}}),K(e)}})},N=(t,e)=>{if(!t.target.classList.contains("delete-button"))if(t.ctrlKey){let l=k.resolve({name:B,params:{characterId:e}}).href;window.open(l,"_blank")}else k.push({name:B,params:{characterId:e}})},y=t=>{let e=n.characters.find(l=>l.id===t);return e||{}},L=(t,e)=>{t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("buildId",e)},w=(t,e)=>{try{let l=t.dataTransfer.getData("buildId");l&&l!==""&&(n.groups.forEach(c=>{if(c.buildIds.includes(l)){let u=c.buildIds.indexOf(l);c.buildIds.splice(u,1)}}),e!=="none"&&e.buildIds.push(l))}catch{}};return(t,e)=>{const l=h("p-divider"),c=h("p-inputText"),u=h("p-button"),Z=h("p-inplace"),D=h("p-image"),A=h("p-accordionTab"),ee=h("p-accordion");return i(),f("div",me,[s("div",he,p(t.$t("charactersPage.title")),1),s("div",fe,p(t.$t("charactersPage.description")),1),r(l),s("div",null,[s("div",ve,[s("div",_e,p(t.$t("charactersPage.codeInputLabel"))+":",1),r(c,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),placeholder:t.$t("charactersPage.codeInputPlaceholder"),class:"flex-grow-1 py-2"},null,8,["modelValue","placeholder"]),r(u,{icon:"mdi mdi-plus-thick",disabled:!V.value,label:t.$t("charactersPage.codeInputButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:J},null,8,["disabled","label"])]),!V.value&&g.value!==""?(i(),f("div",ge,p(t.$t("charactersPage.invalidBuildCode")),1)):ie("",!0)]),r(l),s("div",ye,[s("div",Ce,[s("div",xe,p(t.$t("charactersPage.savedCharactersTitle")),1),ke,r(u,{icon:"mdi mdi-folder",label:t.$t("charactersPage.createNewGroupButton"),class:"create-character-button py-1 pr-3 pl-2",onClick:Q},null,8,["label"])]),s("div",be,[r(ee,{multiple:"","active-index":M.value},{default:v(()=>[(i(!0),f(I,null,P($(n).groups,a=>(i(),C(A,{key:a.id},{header:v(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",onDrop:o=>w(o,a),onDragover:e[2]||(e[2]=d(()=>{},["prevent"])),onDragenter:e[3]||(e[3]=d(()=>{},["prevent"]))},[De,r(Z,{closable:!0,pt:{content:{class:"flex align-items-center"},button:{class:"py-1"}},onClick:e[1]||(e[1]=d(()=>{},["stop"]))},{display:v(()=>[s("div",Be,[s("div",Ie,p(a.name),1),Pe])]),content:v(()=>[s("div",$e,[r(c,{modelValue:a.name,"onUpdate:modelValue":o=>a.name=o,class:"py-1",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),Te,r(u,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:d(o=>E(a),["stop"])},null,8,["label","onClick"]),r(u,{icon:"pi pi-trash",class:"ml-3 py-1",onClick:d(o=>X(a),["stop"])},null,8,["onClick"])],40,we)]),default:v(()=>[s("div",{onDrop:o=>w(o,a),onDragover:e[4]||(e[4]=d(()=>{},["prevent"])),onDragenter:e[5]||(e[5]=d(()=>{},["prevent"]))},[(i(!0),f(I,null,P(a.buildIds,o=>(i(),f("div",{key:o,class:"character-entry py-2 mt-2",draggable:"true",onClick:m=>N(m,o),onDragstart:m=>L(m,o)},[s("div",Ne,[s("div",Le,[y(o).class?(i(),C(D,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${y(o).class}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),C(D,{key:1,class:"class-image",src:$(F),"image-style":"width: 40px"},null,8,["src"]))]),r(l,{class:"mx-2",layout:"vertical"}),s("div",Ue,p(y(o).name),1),r(l,{class:"mx-2",layout:"vertical"}),s("div",Re,"Lvl "+p(y(o).level),1),r(l,{class:"mx-2",layout:"vertical"}),r(u,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>b(m,o)},null,8,["onClick"])]),s("div",Ae,[r(G,{character:y(o),"read-only":""},null,8,["character"])]),r(u,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>b(m,o)},null,8,["onClick"])],40,Ee))),128))],40,Ve)]),_:2},1024))),128)),r(A,null,{header:v(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",draggable:"true",onDrop:e[7]||(e[7]=a=>w(a,"none")),onDragover:e[8]||(e[8]=d(()=>{},["prevent"])),onDragenter:e[9]||(e[9]=d(()=>{},["prevent"]))},[Se,je,Fe,r(u,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:e[6]||(e[6]=d(a=>E("none"),["stop"]))},null,8,["label"])],32)]),default:v(()=>[s("div",{onDrop:e[10]||(e[10]=a=>w(a,t.group)),onDragover:e[11]||(e[11]=d(()=>{},["prevent"])),onDragenter:e[12]||(e[12]=d(()=>{},["prevent"]))},[(i(!0),f(I,null,P(Y.value,a=>(i(),f("div",{key:a.id,class:"character-entry py-2 mt-2",draggable:"true",onClick:o=>N(o,a.id),onDragstart:o=>L(o,a.id)},[s("div",Oe,[s("div",qe,[a.class?(i(),C(D,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${a.class}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),C(D,{key:1,class:"class-image",src:$(F),"image-style":"width: 40px"},null,8,["src"]))]),r(l,{class:"mx-2",layout:"vertical"}),s("div",We,p(a.name),1),r(l,{class:"mx-2",layout:"vertical"}),s("div",ze,"Lvl "+p(a.level),1),r(l,{class:"mx-2",layout:"vertical"}),r(u,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:o=>b(o,a.id)},null,8,["onClick"])]),s("div",He,[r(G,{character:a,"read-only":""},null,8,["character"])]),r(u,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:o=>b(o,a.id)},null,8,["onClick"])],40,Ge))),128))],32)]),_:1})]),_:1},8,["active-index"])])])])}}},Je=te(Ke,[["__scopeId","data-v-ff92eafd"]]);export{Je as default};
