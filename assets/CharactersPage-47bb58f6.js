import{_ as ee,u as te,a as se,b as ae,c as le,i as re,r as j,d as oe,e as ne,f as q,g as h,o as i,h as f,j as s,t as p,k as o,l as ce,w as v,C as I,v as ie,F as P,m as T,n as x,p as d,q as $,s as de,x as ue}from"./index-1abbe7a0.js";import{a as F,E as G}from"./addCompanion-26ce0a46.js";const g=y=>(de("data-v-3d1093f0"),y=y(),ue(),y),pe={class:"flex flex-column flex-grow-1 ml-4 mr-3",style:{height:"100%",overflow:"hidden"}},me={class:"mt-3",style:{"font-size":"42px"}},he={class:"mt-2"},fe={class:"flex align-items-center w-full"},ve={class:"text-xl mr-3"},ge={key:0,class:"mt-2",style:{color:"var(--error)"}},_e={class:"character-area"},Ce={class:"flex w-full"},xe={class:"text-xl"},ye=g(()=>s("div",{class:"flex-grow-1"},null,-1)),ke={class:"character-enties-wrapper flex flex-column mt-2 pb-3"},be=["onDrop"],we=g(()=>s("i",{class:"mdi mdi-folder"},null,-1)),De={class:"flex"},Ie={class:"mx-2"},Be=g(()=>s("i",{class:"mdi mdi-pencil"},null,-1)),Pe={class:"px-3"},Te=g(()=>s("div",{class:"flex-grow-1"},null,-1)),$e=["onDrop"],Ee=["onClick","onDragstart"],Ve={class:"character-info flex align-items-center justify-content-left flex-grow-1"},Ne={class:"ml-3"},Le={class:"class-name flex-grow-1 truncate"},Ue={class:"class-level"},Re={class:"character-items flex-grow-1"},Ae=g(()=>s("i",{class:"mdi mdi-folder"},null,-1)),Oe=g(()=>s("div",{class:"mx-2"},"Ungrouped",-1)),Se=g(()=>s("div",{class:"flex-grow-1"},null,-1)),je=["onClick","onDragstart"],qe={class:"character-info flex align-items-center justify-content-left flex-grow-1"},Fe={class:"ml-3"},Ge={class:"class-name flex-grow-1 truncate"},We={class:"class-level"},ze={class:"character-items flex-grow-1"},He={__name:"CharactersPage",setup(y){var A,O;te();const E=se(),{t:B}=ae(),k=le(),n=re("masterData"),_=j(""),{decodeBuildCode:W}=oe(),{createNewCharacter:z,createNewCharacterFromCode:H,deleteCharacter:V}=ne(n),K=j([...((A=n.groups)==null?void 0:A.keys())||[0],(O=n.groups)==null?void 0:O.length]),N=q(()=>W(_.value)!==null),M=q(()=>{var a;let t=[];return(a=n.groups)==null||a.forEach(c=>{t.push(...c.buildIds)}),n.characters.filter(c=>!t.includes(c.id))}),L=t=>{let e=z();t!=="none"&&t.buildIds.push(e.id),k.push({name:I,params:{characterId:e.id}})},J=()=>{let t=H(_.value);k.push({name:I,params:{characterId:t.id}})},Q=()=>{n.groups.push({id:ie(),name:B("charactersPage.newGroup"),buildIds:[]})},X=(t,e)=>{if(e.buildIds.length===0){let a=n.groups.indexOf(e);n.groups.splice(a,1)}else E.require({group:"dialog",target:t.currentTarget,message:B("confirms.willDeleteCharacters"),accept:()=>{e.buildIds.forEach(c=>{V(c)});let a=n.groups.indexOf(e);n.groups.splice(a,1)}})},b=(t,e)=>{E.require({group:"popup",target:t.currentTarget,message:B("confirms.irreversable"),accept:()=>{n.groups.forEach(a=>{if(a.buildIds.includes(e)){let c=a.buildIds.indexOf(e);a.buildIds.splice(c,1)}}),V(e)}})},U=(t,e)=>{if(!t.target.classList.contains("delete-button"))if(t.ctrlKey){let a=k.resolve({name:I,params:{characterId:e}}).href;window.open(a,"_blank")}else k.push({name:I,params:{characterId:e}})},C=t=>{let e=n.characters.find(a=>a.id===t);return e||{}},R=(t,e)=>{t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("buildId",e)},w=(t,e)=>{try{let a=t.dataTransfer.getData("buildId");a&&a!==""&&(n.groups.forEach(c=>{if(c.buildIds.includes(a)){let u=c.buildIds.indexOf(a);c.buildIds.splice(u,1)}}),e!=="none"&&e.buildIds.push(a))}catch{}};return(t,e)=>{const a=h("p-divider"),c=h("p-inputText"),u=h("p-button"),Y=h("p-inplace"),D=h("p-image"),S=h("p-accordionTab"),Z=h("p-accordion");return i(),f("div",pe,[s("div",me,p(t.$t("charactersPage.title")),1),s("div",he,p(t.$t("charactersPage.description")),1),o(a),s("div",null,[s("div",fe,[s("div",ve,p(t.$t("charactersPage.codeInputLabel"))+":",1),o(c,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l),placeholder:t.$t("charactersPage.codeInputPlaceholder"),class:"flex-grow-1 py-2"},null,8,["modelValue","placeholder"]),o(u,{icon:"mdi mdi-plus-thick",disabled:!N.value,label:t.$t("charactersPage.codeInputButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:J},null,8,["disabled","label"])]),!N.value&&_.value!==""?(i(),f("div",ge,p(t.$t("charactersPage.invalidBuildCode")),1)):ce("",!0)]),o(a),s("div",_e,[s("div",Ce,[s("div",xe,p(t.$t("charactersPage.savedCharactersTitle")),1),ye,o(u,{icon:"mdi mdi-folder",label:t.$t("charactersPage.createNewGroupButton"),class:"create-character-button py-1 pr-3 pl-2",onClick:Q},null,8,["label"])]),s("div",ke,[o(Z,{multiple:"","active-index":K.value},{default:v(()=>[(i(!0),f(P,null,T($(n).groups,l=>(i(),x(S,{key:l.id},{header:v(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",onDrop:r=>w(r,l),onDragover:e[2]||(e[2]=d(()=>{},["prevent"])),onDragenter:e[3]||(e[3]=d(()=>{},["prevent"]))},[we,o(Y,{closable:!0,pt:{content:{class:"flex align-items-center"},button:{class:"py-1"}},onClick:e[1]||(e[1]=d(()=>{},["stop"]))},{display:v(()=>[s("div",De,[s("div",Ie,p(l.name),1),Be])]),content:v(()=>[s("div",Pe,[o(c,{modelValue:l.name,"onUpdate:modelValue":r=>l.name=r,class:"py-1",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),Te,o(u,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:d(r=>L(l),["stop"])},null,8,["label","onClick"]),o(u,{icon:"pi pi-trash",class:"delete-button ml-3 py-1",onClick:d(r=>X(r,l),["stop"])},null,8,["onClick"])],40,be)]),default:v(()=>[s("div",{onDrop:r=>w(r,l),onDragover:e[4]||(e[4]=d(()=>{},["prevent"])),onDragenter:e[5]||(e[5]=d(()=>{},["prevent"]))},[(i(!0),f(P,null,T(l.buildIds,r=>(i(),f("div",{key:r,class:"character-entry py-2 mt-2",draggable:"true",onClick:m=>U(m,r),onDragstart:m=>R(m,r)},[s("div",Ve,[s("div",Ne,[C(r).class?(i(),x(D,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${C(r).class}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),x(D,{key:1,class:"class-image",src:$(F),"image-style":"width: 40px"},null,8,["src"]))]),o(a,{class:"mx-2",layout:"vertical"}),s("div",Le,p(C(r).name),1),o(a,{class:"mx-2",layout:"vertical"}),s("div",Ue,"Lvl "+p(C(r).level),1),o(a,{class:"mx-2",layout:"vertical"}),o(u,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:m=>b(m,r)},null,8,["onClick"])]),s("div",Re,[o(G,{character:C(r),"read-only":""},null,8,["character"])]),o(u,{class:"at-end-delete-button delete-button py-2 px-2 mr-3 h-full",icon:"pi pi-trash",onClick:m=>b(m,r)},null,8,["onClick"])],40,Ee))),128))],40,$e)]),_:2},1024))),128)),o(S,null,{header:v(()=>[s("div",{class:"flex align-items-center w-full px-3 py-2",draggable:"true",onDrop:e[7]||(e[7]=l=>w(l,"none")),onDragover:e[8]||(e[8]=d(()=>{},["prevent"])),onDragenter:e[9]||(e[9]=d(()=>{},["prevent"]))},[Ae,Oe,Se,o(u,{icon:"mdi mdi-plus-thick",label:t.$t("charactersPage.createNewCharacterButton"),class:"create-character-button py-1 pr-3 pl-2 ml-3",onClick:e[6]||(e[6]=d(l=>L("none"),["stop"]))},null,8,["label"])],32)]),default:v(()=>[s("div",{onDrop:e[10]||(e[10]=l=>w(l,t.group)),onDragover:e[11]||(e[11]=d(()=>{},["prevent"])),onDragenter:e[12]||(e[12]=d(()=>{},["prevent"]))},[(i(!0),f(P,null,T(M.value,l=>(i(),f("div",{key:l.id,class:"character-entry py-2 mt-2",draggable:"true",onClick:r=>U(r,l.id),onDragstart:r=>R(r,l.id)},[s("div",qe,[s("div",Fe,[l.class?(i(),x(D,{key:0,class:"class-image",src:`https://tmktahu.github.io/WakfuAssets/classes/${l.class}.png`,"image-style":"width: 40px"},null,8,["src"])):(i(),x(D,{key:1,class:"class-image",src:$(F),"image-style":"width: 40px"},null,8,["src"]))]),o(a,{class:"mx-2",layout:"vertical"}),s("div",Ge,p(l.name),1),o(a,{class:"mx-2",layout:"vertical"}),s("div",We,"Lvl "+p(l.level),1),o(a,{class:"mx-2",layout:"vertical"}),o(u,{class:"by-level-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:r=>b(r,l.id)},null,8,["onClick"])]),s("div",ze,[o(G,{character:l,"read-only":""},null,8,["character"])]),o(u,{class:"at-end-delete-button delete-button py-2 px-2 mr-3",icon:"pi pi-trash",onClick:r=>b(r,l.id)},null,8,["onClick"])],40,je))),128))],32)]),_:1})]),_:1},8,["active-index"])])])])}}},Je=ee(He,[["__scopeId","data-v-3d1093f0"]]);export{Je as default};
